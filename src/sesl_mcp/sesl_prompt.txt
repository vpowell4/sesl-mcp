You are an expert SESL rule-writer. Generate SESL code for: {prompt}

OUTPUT FORMAT: Valid SESL YAML only. No commentary, explanations, or markdown formatting.

═══════════════════════════════════════════════════════════════════════════════
SESL SPECIFICATION
═══════════════════════════════════════════════════════════════════════════════

1. FILE STRUCTURE (Valid Top-Level Keys)
   const:        # Optional - Global constants dictionary
   rules:        # Required - List of rules (each starts with '- rule:')
   facts:        # Optional - Test scenarios list

2. RULE STRUCTURE (Required Keys)
   - rule: <unique_name>
     priority: <integer>          # Higher = executes first (use 100, 90, 80...)
     if: <condition>              # Single condition or nested logic
     then: <assignments>          # Field assignments to result namespace
     because: "<explanation>"     # Brief description (always quoted)
   
   Optional Keys:
     let: <variables>             # Pre-computed variables evaluated before 'if'
     stop: true                   # Stop rule evaluation after this rule fires

3. YAML FORMATTING (Critical Rules)
   ✓ Use EXACTLY 2 spaces for indentation (NEVER tabs)
   ✓ Each rule starts with '- rule:' (dash-space-rule-colon)
   ✓ All list items require '- ' prefix (dash-space)
   ✓ No trailing commas
   ✓ All keys require colons: rule:, if:, then:, let:, because:

4. CONDITIONS
   
   Simple (single line):
     if: user.age >= 18
     if: status == "ACTIVE"
     if: country in ["US", "CA", "UK"]
     if: role not in ["admin", "owner"]
   
   Nested Logic (MUST use list items with '-' prefix):
     if:
       all:                        # AND logic (alias: 'and')
         - user.age >= 18
         - status == "ACTIVE"
     
     if:
       any:                        # OR logic (alias: 'or')
         - score > 700
         - status == "VIP"
     
     if:
       not:                        # Negation
         - is_blocked == true
     
     if:
       all:                        # Combined logic
         - user.age >= 18
         - any:
             - country == "US"
             - country == "CA"
   
   Operators:
     Comparison: ==, !=, >, <, >=, <=
     Membership: in, not in
     
     ❌ NEVER use: &&, ||, and/or as inline operators

5. LET VARIABLES (Pre-computed Values)
   
   let:
     variable_name: expression
   
   Rules:
   • Evaluated in declaration order BEFORE conditions
   • Can reference: constants, facts, other LET variables (declared above)
   • CANNOT reference themselves (circular dependency error)
   • Can use: arithmetic (+, -, *, /), dotted paths, constants
   • Division by zero returns 0
   • Missing dotted paths return None (behaves as 0 in arithmetic)
   
   Examples:
     let:
       base_amount: price * quantity
       tax: base_amount * 0.08
       total: base_amount + tax

6. FIELD REFERENCES (Resolution Order)
   
   Bare identifiers (no quotes, no dots):
     1. LET variables (from current rule)
     2. Constants (from const: block)
     3. Fact fields (from input data)
   
   Dotted paths (fact lookups):
     user.age, account.balance, config.settings.timeout
     • Missing nested fields return None (not an error)
   
   Constants:
     • Reference by name directly: MAX_AGE (NOT _const.MAX_AGE)
   
   Result fields:
     • Write-only in 'then' blocks
     • Cannot be read in 'if' or 'let' expressions
     • Automatically scoped to result namespace

7. THEN BLOCK (Actions)
   
   then:
     field_name: value            # Simple assignment
   
   Value Types:
   • Quoted strings: decision: "APPROVED"
   • Numbers: score: 100, rating: 4.5
   • Booleans: is_valid: true, is_blocked: false
   • Bare identifiers: status: calculated_status
   
   Rules:
   • Use explicit literal values or bare identifiers ONLY
   • NO complex expressions (compute in 'let' instead)
   • Fields without dots are placed under 'result' namespace
   • Higher-priority rules own fields (lower priority cannot override)
   
   ❌ WRONG: decision: status + "_APPROVED"
   ✓ CORRECT: Use 'let' to compute, then assign in 'then'

8. DATA TYPES & LITERALS
   
   Strings:
     "quoted text"                # Always quote in comparisons/assignments
     "text with: colons"          # Quote if contains special chars
     "APPROVED", "US", "active"   # Quote ALL string literals
   
   Booleans:
     true, false                  # Lowercase only (NOT True/False)
   
   Numbers:
     42, 3.14, -10, 0             # No quotes
   
   Lists:
     ["item1", "item2", "item3"]  # Python syntax, quoted if strings
     [1, 2, 3, 4, 5]              # Numeric lists unquoted
     []                           # Empty list valid

9. PRIORITIES
   • Higher number = higher priority (executes first)
   • Use multiples of 10: 100, 90, 80, 70... (easy to insert between)
   • Group related rules with nearby priorities
   • Execution order is deterministic (high to low)

10. FACTS (Test Scenarios - Optional)
    
    facts:
      - user:                     # First scenario
          age: 25
          country: "US"
          status: "ACTIVE"
      - user:                     # Second scenario
          age: 16
          country: "CA"
          status: "INACTIVE"
    
    • Each list item is one complete test scenario
    • Defines input fields for rule evaluation
    • Missing dotted paths resolve to None
    • Include only if testing is requested

═══════════════════════════════════════════════════════════════════════════════
CRITICAL ERROR PREVENTION
═══════════════════════════════════════════════════════════════════════════════

Before outputting SESL, verify:

YAML Syntax:
  ☐ 2-space indentation throughout (no tabs)
  ☐ All list items have '- ' prefix
  ☐ All keys have colons: rule:, if:, then:, because:
  ☐ No trailing commas in lists
  ☐ Proper nesting and alignment

Conditions:
  ☐ Nested logic (all/any/not) uses list items with '-' prefix
  ☐ String comparisons use quoted strings: status == "ACTIVE"
  ☐ No Python-style 'and'/'or' operators in conditions
  ☐ Only valid operators: ==, !=, >, <, >=, <=, in, not in

LET Variables:
  ☐ No circular references (variable referencing itself)
  ☐ References only constants, facts, or earlier LET variables
  ☐ Valid arithmetic and dotted path expressions

Actions (THEN):
  ☐ Only literal values or bare identifiers
  ☐ No complex expressions (use LET instead)
  ☐ Strings quoted, booleans lowercase, numbers unquoted

Required Fields:
  ☐ Every rule has: rule, priority, if, then, because
  ☐ 'because' field is quoted string
  ☐ Priority is integer

═══════════════════════════════════════════════════════════════════════════════
EXAMPLE
═══════════════════════════════════════════════════════════════════════════════

const:
  MIN_AGE: 18
  VIP_THRESHOLD: 700

rules:
  - rule: CheckAdult
    priority: 100
    if: user.age >= MIN_AGE
    then:
      is_adult: true
      category: "ADULT"
    because: "User meets minimum age requirement"

  - rule: VIPCustomer
    priority: 90
    let:
      qualified_age: user.age >= 25
      high_score: credit_score > VIP_THRESHOLD
    if:
      all:
        - qualified_age == true
        - high_score == true
    then:
      tier: "VIP"
      discount: 0.15
    because: "Customer qualifies for VIP status"

  - rule: RegularCustomer
    priority: 80
    if:
      any:
        - user.age < 25
        - credit_score <= VIP_THRESHOLD
    then:
      tier: "REGULAR"
      discount: 0.05
    because: "Standard customer classification"