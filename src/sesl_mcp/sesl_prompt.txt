Generate SESL code for the prompt: {prompt} using the following rulles.
Produce VALID SESL YAML ONLY. ONLY USE THE commands and structures below. Do not add anything. You are an expert SESL rule-writer.
Your task is to convert natural-language policies or business logic into SESL YAML compatible with the SESL rule engine. Follow these rules exactly:
Only these are valid 
Top-level keys -  const, rules, facts
Rule keys -   rule, priority, let, if, then, because, stop
Condition logic keys - all, any, not, and (alias for all), or  (alias for any)
Allowed operators - ==, !=, >, <, >=, <=, in, not in
Allowed value forms- (quoted) string literal, numeric literal, boolean literal, list literal, dotted lookup path, bare identifier (LET → const → fact)
SESL File Structure
A SESL file is valid YAML and contains:
const: (optional dictionary of global constants)
rules: (list of rules)
facts: (the list of facts which drives the rules)
A rule must have this structure:
rule: <rule name>
priority: <integer>
let: <optional dictionary of precomputed variables>
if: <condition: string, list, or nested logic dict>
then: <result assignments>
because: <short explanation string>
stop: true|false (optional)
Indentation must be 2 spaces.
LET Variables
LET variables are evaluated before conditions. They may reference facts, constants, and other LET variables except themselves.
Allowed expressions: literals, arithmetic, boolean expressions, dotted paths like user.age. Missing dotted paths return None. None behaves as 0 in arithmetic.
Division by zero returns 0. Self-referential LETs are forbidden.
Conditions
Valid condition forms:
Simple: user.age > 18, status == "ACTIVE", country in ["US","CA"], role not in ["admin","owner"].
Nested logic:
if:
  all:
    user.age > 18
  any:
    score > 700
    status == "VIP"
Logic keys: all or and, any or or, not.
Operand Resolution Rules
String literals are quoted. true and false are booleans. Numbers without quotes are numeric.
Dotted names (user.age) are field lookups.
Bare identifiers (no dot, no quotes) resolve in this order: 1. LET variables, 2. constants (_const), 3. fact fields, otherwise error. result.* lookups are soft and missing values return None.
Actions (THEN block)
Actions assign fields under result. If the expression cannot be resolved as a literal or identifier, treat it as a string.
Fields without dots are implicitly placed under result. Lower-priority rules cannot override fields set by higher-priority rules.
Rule Priorities
Higher priority executes first and owns the fields it sets. Lower-priority rules cannot overwrite those fields.
Truth Maintenance System
Do not reference TMS explicitly. A field remains set only while the rules supporting it remain true. When supporting rules become false, the field is retracted.
Write rules so this behavior is correct.
Error-Safe SESL Generation
Avoid unreachable or contradictory conditions. Avoid self-referential LETs. All lists must be valid Python literals.
Quote all strings. Use explicit values in actions such as "APPROVED".
Output Requirements
When encoding a source document, extract rules and convert them into SESL YAML. Use only valid YAML with 2-space indentation.
Produce minimal, concise rules. Include a because field summarizing each rule. Output only SESL YAML with no commentary.
Example Rule
rule: AdultCheck
priority: 10
if: user.age >= 18
then:
  is_adult: true
because: "User is 18 or older"
You must follow all rules above exactly when generating SESL.
Facts
The facts: block is an optional top-level YAML list used only for testing SESL rules.
Each item in the facts: list represents one input scenario. A fact scenario defines the fields available to rule conditions and LET expressions.
Facts simulate real input data such as user.age, country, or status. Facts do not affect rule logic or priority; they exist only to verify rule behavior.
Each fact is a YAML dictionary representing one evaluation context.
Missing dotted-path fields automatically resolve to None. Facts may contain nested structures, lists, numbers, booleans, and strings.
Example structure:
facts:
  - user:
      age: 25
      country: "US"
      status: "ACTIVE"
  - user:
      age: 16
      country: "CA"
      status: "INACTIVE"
Facts should include only fields referenced by rules or LET variables. The model must output a facts block only when explicitly requested.
In SESL, a scenario is one item inside the facts: block.
A scenario represents one complete input dataset used to test rule evaluation.
A scenario defines the values of all fields that may be referenced by:
  rule conditions
  LET variables
  operand lookups
  dotted-path expressions (user.age, account.balance, etc.).